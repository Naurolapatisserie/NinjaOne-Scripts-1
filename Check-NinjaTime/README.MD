# Variables de Script : Modes de Planification & Param√®tres

Ce document d√©crit les variables de script configurables utilis√©es pour d√©finir le comportement de planification dans le script. La planification est contr√¥l√©e par une combinaison de modes d'ex√©cution (`Mode`) et de param√®tres de support qui varient selon le mode s√©lectionn√©.

---

## üìã Aper√ßu des Variables de Script

| Variable                  | Utilis√©e Pour                  | Type      | Notes                                                                 |
|---------------------------|---------------------------|-----------|-----------------------------------------------------------------------|
| `Mode`                   | Type d'ex√©cution             | LISTE D√âROULANTE  | Requis. Options : `Once`, `Daily`, `Weekly`, `Monthly`, `Window`    |
| `Target Time`            | Heure ou DateTime           | DATETIME  | DateTime complet pour `Once`, heure seulement pour `Daily`, `Weekly`, et `Monthly` |
| `Weekly Day Of Week`     | Mode hebdomadaire                | TEXTE      | Jours s√©par√©s par des virgules (ex. `Monday,Wednesday`)                      |
| `Monthly Day Of Month`   | Mode mensuel               | ENTIER   | Jour num√©rique du mois (1‚Äì31)                                      |
| `Window Recurrence`      | R√©currence de fen√™tre          | LISTE D√âROULANTE  | Requis pour le mode `Window`. Options : `Daily`, `Weekly`               |
| `Window Start`           | D√©but de fen√™tre            | DATETIME  | Seule l'heure est utilis√©e                                                       |
| `Window End`             | Fin de fen√™tre              | DATETIME  | Seule l'heure est utilis√©e                                                       |
| `Window Day of Week`     | Mode fen√™tre hebdomadaire         | TEXTE      | Requis si `Window Recurrence` est `Weekly` ; s√©par√©s par des virgules         |

---

## üîÑ Comportement des Modes et Champs Requis

### `Once`
- **Utilise** : `Target Time` complet (date et heure)
- **Requis** : `Target Time`

### `Daily`
- **Utilise** : Heure de `Target Time`
- **Requis** : `Target Time`

### `Weekly`
- **Utilise** : Heure de `Target Time` et `Weekly Day Of Week`
- **Requis** : `Target Time`, `Weekly Day Of Week`

### `Monthly`
- **Utilise** : Heure de `Target Time` et `Monthly Day Of Month`
- **Requis** : `Target Time`, `Monthly Day Of Month`

### `Window`
- **Utilise** : `Window Recurrence`, `Window Start`, `Window End`, optionnellement `Window Day of Week`
- **Requis** :
  - `Window Recurrence`
  - `Window Start`
  - `Window End`
  - `Window Day of Week` (si la r√©currence est `Weekly`)

---
**Note Importante sur les R√©initialisations de Conditions et les Timeouts de Script**

Il n'est pas recommand√© d'utiliser "When no longer" pour aucun mode - utilisez uniquement les r√©initialisations bas√©es sur le temps.

Pour tout mode, il est important d'ajuster la variable $TimeWindowMinutes dans le script pour √™tre synchronis√©e avec votre intervalle et timeout de script. Par exemple, si j'ex√©cute ma condition compos√©e toutes les 15 minutes, je d√©finirais mon $TimeWindowMinutes √† 16 minutes. Cela permet au script de dormir jusqu'√† ce que le $TargetTime d√©sir√© soit atteint. Je dois m'assurer que le timeout du script d√©passe mon $TimeWindowMinutes - donc dans mon cas je le mettrais √† 17 minutes.
-Intervalle du script
-$TimeWindowMinutes = intervalle + 1 minute
-Timeout du script = intervalle + 2 minutes

Lors de l'utilisation du mode Window, il devient √©galement important de s'assurer que la r√©initialisation automatique est plus longue que la fen√™tre de maintenance - c.-√†-d. une fen√™tre de maintenance de 4 heures devrait avoir un temps de r√©initialisation automatique de 4 heures ou plus. Si la r√©initialisation est trop courte, l'automatisation pourrait potentiellement se d√©clencher √† nouveau s'il n'y a pas un moniteur de changement d'√©tat ad√©quat dans la condition compos√©e.
